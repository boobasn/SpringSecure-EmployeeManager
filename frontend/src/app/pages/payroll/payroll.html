<div class="payroll-container">
  <h1>Gestion de la Paie</h1>

  <!-- ğŸ” RECHERCHE & FILTRES -->
  <div class="search-section">

    <input
      type="text"
      placeholder="ID EmployÃ©"
      [(ngModel)]="employeeId"
    />

    <button (click)="searchByEmployee()">
      ğŸ” Rechercher
    </button>

    <select [(ngModel)]="selectedMonth">
      <option [ngValue]="null">Mois</option>
      <option *ngFor="let m of months" [value]="m">
        {{ m }}
      </option>
    </select>

    <select [(ngModel)]="selectedYear">
      <option [ngValue]="null">AnnÃ©e</option>
      <option *ngFor="let y of years" [value]="y">
        {{ y }}
      </option>
    </select>

    <button (click)="searchByMonth()">ğŸ“… Filtrer</button>

    <button (click)="generateBatch()">
      âš™ GÃ©nÃ©rer Batch
    </button>
    
    <button (click)="loadPayrolls()">
      ğŸ”„ RÃ©initialiser
    </button>

  </div>

  <!-- STATS -->
  <div class="stats">
    <div class="card">
      <h2>{{ payrolls.length }}</h2>
      <p>Total Paies</p>
    </div>

    <div class="card green">
      <h2>{{ paidCount }}</h2>
      <p>PayÃ©es</p>
    </div>

    <div class="card orange">
      <h2>{{ generatedCount }}</h2>
      <p>En attente</p>
    </div>
  </div>

  <!-- TABLE -->
  <table>
    <thead>
      <tr>
        <th>EmployÃ©</th>
        <th>Mois</th>
        <th>Base</th>
        <th>Net</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let p of payrolls">
        <td>{{ p.employeeFirstName }}</td>
        <td>{{ p.month }}/{{ p.year }}</td>
        <td>{{ p.baseSalary }} F</td>
        <td>{{ p.netSalary }} F</td>

        <td>
          <span
            class="badge"
            [class.paid]="p.status === 'PAID'"
            [class.generated]="p.status === 'GENERATED'">
            {{ p.status }}
          </span>
        </td>

        <td class="actions">
          <button (click)="viewDetails(p)">ğŸ‘</button>
          <button (click)="download(p)">ğŸ“„</button>

          <button
            class="pay"
            *ngIf="p.status !== 'PAID'"
            (click)="markPaid(p)">
            âœ” Payer
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- MODAL -->
  <div class="modal" *ngIf="selectedPayroll as p">
    <div class="modal-content">
      <h2>DÃ©tails Paie</h2>

      <p><strong>EmployÃ© :</strong> {{ p.employeeFirstName }}</p>
      <p><strong>Mois :</strong> {{ p.month }}/{{ p.year }}</p>

      <hr />

      <p>Salaire Base : {{ p.baseSalary }} F</p>
      <p>Bonus : {{ p.bonuses }} F</p>
      <p>IndemnitÃ©s : {{ p.allowances }} F</p>
      <p>DÃ©ductions : {{ p.deductions }} F</p>

      <h3>NET Ã€ PAYER : {{ p.netSalary }} F</h3>

      <button class="close" (click)="selectedPayroll = null">
        Fermer
      </button>
    </div>
  </div>

</div>
